<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reservas - Admin</title>
    <style>
        /* Copia los mismos estilos :root y sidebar del archivo anterior (E6F1) */
        :root { --primary: #042490; --primary-gradient: linear-gradient(135deg, #021B79 0%, #0575E6 100%); --bg-page: #F8FAFC; --text-dark: #1E293B; --text-light: #64748B; --success: #10B981; }
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI', sans-serif; }
        body { background: var(--bg-page); color: var(--text-dark); display: flex; min-height: 100vh; }
        
        .sidebar { width: 280px; background: var(--primary-gradient); color: white; padding: 30px 20px; display: flex; flex-direction: column; box-shadow: 4px 0 20px rgba(0,0,0,0.1); position: sticky; top: 0; height: 100vh; }
        .logo { font-size: 22px; font-weight: 800; margin-bottom: 50px; display: flex; align-items: center; gap: 12px; background: rgba(255,255,255,0.1); padding: 15px; border-radius: 16px; backdrop-filter: blur(5px); border: 1px solid rgba(255,255,255,0.2); }
        .nav-group { display: flex; flex-direction: column; gap: 10px; flex: 1; }
        .nav-item { padding: 14px 20px; color: rgba(255,255,255,0.7); text-decoration: none; border-radius: 14px; transition: 0.3s; font-weight: 600; font-size: 15px; display: flex; align-items: center; gap: 12px; border: 1px solid transparent; }
        .nav-item:hover { background: rgba(255,255,255,0.15); color: white; transform: translateX(5px); }
        .nav-item.active { background: white; color: var(--primary); box-shadow: 0 5px 15px rgba(0,0,0,0.2); font-weight: 800; }
        .nav-footer { margin-top: auto; border-top: 1px solid rgba(255,255,255,0.2); padding-top: 20px; }

        .main-content { flex: 1; padding: 40px; overflow-y: auto; }
        .page-title { font-size: 28px; font-weight: 800; margin-bottom: 30px; }
        
        .card { background: white; border-radius: 20px; padding: 0; box-shadow: 0 4px 20px rgba(0,0,0,0.05); overflow: hidden; }
        table { width: 100%; border-collapse: collapse; }
        th { text-align: left; padding: 20px; background: #F8FAFC; color: var(--text-light); font-size: 12px; text-transform: uppercase; font-weight: 700; }
        td { padding: 20px; border-bottom: 1px solid #F1F5F9; vertical-align: middle; }
        
        .btn-confirm { background: var(--success); color: white; border: none; padding: 8px 16px; border-radius: 8px; cursor: pointer; font-weight: 700; transition: 0.2s; }
        .btn-confirm:hover { transform: translateY(-2px); box-shadow: 0 4px 10px rgba(16, 185, 129, 0.3); }
    </style>
</head>
<body>
    <div class="sidebar">
        <div class="logo">üî• Admin Panel</div>
        <div class="nav-group">
            <a href="E6F1.html" class="nav-item"><span>üìä</span> Dashboard</a>
            <a href="E6F3.html" class="nav-item"><span>ü•©</span> Productos</a>
            <a href="E6F2.html" class="nav-item active"><span>üìÖ</span> Reservas</a>
        </div>
        <div class="nav-footer">
            <a href="E2F1.html" class="nav-item" target="_blank" style="background: rgba(255,255,255,0.1);"><span>üåê</span> Ver Tienda</a>
        </div>
    </div>

    <div class="main-content">
        <h2 class="page-title">Gesti√≥n de Reservas</h2>
        <div class="card">
            <table>
                <thead>
                    <tr>
                        <th>Cliente</th>
                        <th>Fecha / Hora</th>
                        <th>Personas</th>
                        <th>Estado</th>
                        <th>Acci√≥n</th>
                    </tr>
                </thead>
                <tbody id="tablaReservas">
                    <tr><td colspan="5" style="text-align:center; padding:30px;">Cargando...</td></tr>
                </tbody>
            </table>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', cargarReservas);

        async function cargarReservas() {
            try {
                const response = await fetch('http://127.0.0.1:8000/reservations');
                const reservas = await response.json();
                const tbody = document.getElementById('tablaReservas');
                tbody.innerHTML = '';

                reservas.forEach(r => {
                    let estadoColor = r.estado === 'Confirmada' ? '#D1FAE5' : '#FEF3C7';
                    let btn = r.estado !== 'Confirmada' 
                        ? `<button class="btn-confirm" onclick="confirmar('${r.id}')">‚úì Confirmar</button>` 
                        : '<strong style="color:#059669">Listo</strong>';

                    tbody.innerHTML += `
                        <tr>
                            <td>
                                <strong>${r.cliente_nombre}</strong><br>
                                <span style="font-size:13px; color:#64748B">${r.telefono}</span>
                            </td>
                            <td>${r.fecha_hora}</td>
                            <td>${r.asistentes} pers.</td>
                            <td><span style="background:${estadoColor}; padding:4px 10px; border-radius:20px; font-size:12px; font-weight:700;">${r.estado}</span></td>
                            <td>${btn}</td>
                        </tr>
                    `;
                });
            } catch (e) { console.error(e); }
        }

        async function confirmar(id) {
            if(confirm("¬øConfirmar mesa?")) {
                await fetch(`http://127.0.0.1:8000/reservations/${id}?estado=Confirmada`, { method: 'PUT' });
                cargarReservas();
            }
        }
    </script>
</body>
</html>